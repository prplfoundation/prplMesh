
sudo: required
dist: xenial
language: python2.7

services:
  - docker

script:
  - cd tools/docker
  - sudo ./image-build.sh -b ubuntu:18.04
  # Run clang-format and check there are no modified files by checking git status
  - sudo ./clang-format.sh
  - git diff-index --exit-code HEAD
  - sudo ./build.sh map -f CMAKE_BUILD_TYPE=Debug BUILD_TESTS=ON
  # Check that the AutoGenerated files are correct by checking git status
  - git update-index -q --refresh
  - git diff-index --exit-code HEAD
  # Start controller & agent node detached and check status
  - sudo ./tests/test_gw_repeater.sh --rm || true
